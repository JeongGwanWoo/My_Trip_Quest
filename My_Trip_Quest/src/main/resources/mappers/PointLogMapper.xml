<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.tripquest.mapper.PointLogMapper">

    <insert id="save" parameterType="com.ssafy.tripquest.domain.PointLog">
        INSERT INTO point_logs (user_id, transaction_type, amount, balance_after, source_type, source_id, description)
        VALUES (#{userId}, #{transactionType}, #{amount}, #{balanceAfter}, #{sourceType}, #{sourceId}, #{description})
    </insert>

    <select id="findMissionCompletionTime" resultType="java.util.Date">
        SELECT created_at
        FROM point_logs
        WHERE user_id = #{userId}
          AND source_type = 'MISSION'
          AND source_id = #{missionId}
        ORDER BY created_at DESC
        LIMIT 1
    </select>

</mapper>
